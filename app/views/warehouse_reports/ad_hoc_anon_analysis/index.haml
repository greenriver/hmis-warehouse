- title = "De-Identified Ad-Hoc Analysis Export"
- content_for :title, title
%h1= title
= render '/warehouse_reports/breadcrumbs', tab: 'exports'
%p Client selection will be limited to those with open enrollments within the date range. Only projects in ES, SO, SH, TH, and PH are included.
= render 'filter'

.warehouse-reports__ad_hoc-export
  - if @reports.exists?
    .row
      .col-8
        %p= page_entries_info @reports, entry_name: _('report')
    .table-responsive
      %table.table.table-sm.table-hover
        %thead
          %tr
            %th Status
            %th Options
            %th Client Count
            %th Run At
            %th Download
            %th
        %tbody.report-listing.warehouse-reports__completed
          - @reports.each do |report|
            %tr
              %td= report.status
              %th
                = render 'parameters', options: report.options, report: report
              %td= report.client_count
              %td.text-nowrap= report.created_at
              %td
                - if report.completed?
                  = link_to warehouse_reports_ad_hoc_anon_analysis_path(report, format: :xlsx), class: 'btn btn-sm btn-secondary' do
                    Download
              %td
                = link_to warehouse_reports_ad_hoc_anon_analysis_path(report), method: :delete, class: 'btn btn-sm btn-danger btn-icon-only', data: {confirm: "Are you sure you want to delete this report?"} do
                  %i.icon-cross

  - else
    %p.text-center.well
      No reports found.
