- content_for :title, _("Warehouse Reports")
%h1= content_for :title

- active_class = ''

%ul.nav.nav-tabs{role: :tablist}
  - @report_definitions.each_with_index do |(group_name, reports), index|
    %li{role: :presentation, class: (index == 0 ? 'active' : '')}
      %a{href: "##{group_name.parameterize.dasherize}", role: :tab, data: {toggle: :tab}, aria: {controls: '#{group_name}'}}
        #{group_name}
  - if can_view_aggregate_health?
    %li{role: :presentation, class: active_class}
      %a{href: '#health-reports', role: :tab, data: {toggle: :tab}, aria: {controls: 'Health Reports'}}
        Health

.tab-content
  - @report_definitions.each_with_index do |(group_name, reports), index|
    - dashed_group_name = group_name.parameterize.dasherize
    %div{role: :tabpanel, class: (index == 0 ? 'active tab-pane' : 'tab-pane'), id: dashed_group_name}
      %h3
        #{group_name}
      %div{class: "o-card-grid warehouse-reports__#{dashed_group_name}"}
        - reports.each do |report|
          - if report
            %article.c-card
              = link_to report.url, class: 'c-card__content' do
                .c-card__title= report.name
                .c-card__description= report.description.html_safe

  - if can_view_aggregate_health?
    #health-reports.tab-pane{role: :tabpanel}
      .warehouse-reports__health-reports
        %h3 Health Reports
        .o-card-grid
          %article.c-card
            = link_to warehouse_reports_health_overview_index_path, class: 'c-card__content' do
              Health Dashboard

= content_for :page_js do
  :javascript
    $('.nav-tabs a').click(function(e) {
      e.preventDefault();
      $(this).tab('show');
    });
    $("ul.nav-tabs a").on("shown.bs.tab", function(e) {
      var id = $(e.target).attr("href").substr(1);
      window.location.hash = id;
    });
    var hash = window.location.hash;
    $('.nav-tabs a[href="' + hash + '"]').tab('show');
