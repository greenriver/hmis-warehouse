{
  "type": "GROUP",
  "link_id": "3.917B",
  "text": "Prior Living Situation",
  "data_collected_about": "HOH_AND_ADULTS",
  "_comment": "For all projects EXCEPT SO, ES, and SH. This element has dependencies that hide/show items as specified.",
  "prefill": true,
  "rule": {
    "operator": "ALL",
    "parts": [
      {
        "variable": "projectType",
        "operator": "NOT_EQUAL",
        "value": 0
      },
      {
        "variable": "projectType",
        "operator": "NOT_EQUAL",
        "value": 1
      },
      {
        "variable": "projectType",
        "operator": "NOT_EQUAL",
        "value": 4
      },
      {
        "variable": "projectType",
        "operator": "NOT_EQUAL",
        "value": 8
      }
    ]
  },
  "item": [
    {
      "type": "DISPLAY",
      "link_id": "3.917B.instruction",
      "text": "Where did the client spend last night? Select the category that most closely matches the client's response.",
      "readonly_text": "Where the client spent the last night."
    },
    {
      "type": "CHOICE",
      "link_id": "3.917B.1",
      "required": false,
      "warn_if_empty": true,
      "text": "Prior Living Situation",
      "pick_list_reference": "PRIOR_LIVING_SITUATION",
      "mapping": {
        "record_type": "ENROLLMENT",
        "field_name": "livingSituation"
      }
    },
    {
      "type": "GROUP",
      "link_id": "3.917B.1.subsidy-group",
      "item": [
        {
          "type": "CHOICE",
          "link_id": "3.917B.1.subsidy",
          "text": "Rental subsidy type",
          "required": true,
          "pick_list_reference": "RentalSubsidyType",
          "mapping": {
            "record_type": "ENROLLMENT",
            "field_name": "rentalSubsidyType"
          },
          "enable_behavior": "ALL",
          "enable_when": [
            {
              "question": "3.917B.1",
              "operator": "EQUAL",
              "answer_code": "RENTAL_BY_CLIENT_WITH_ONGOING_HOUSING_SUBSIDY"
            }
          ]
        }
      ]
    },
    {
      "type": "CHOICE",
      "link_id": "3.917B.2",
      "required": false,
      "warn_if_empty": true,
      "text": "Length of stay in prior living situation",
      "brief_text": "Length of Stay",
      "pick_list_reference": "ResidencePriorLengthOfStay",
      "mapping": {
        "record_type": "ENROLLMENT",
        "field_name": "lengthOfStay"
      }
    },
    {
      "type": "GROUP",
      "component": "INFO_GROUP",
      "link_id": "3.917B.break-group",
      "item": [
        {
          "type": "DISPLAY",
          "link_id": "3.917B.A",
          "read_only": true,
          "text": "Client stayed 90+ days in an institutional setting. This is considered a \"break\" according to the HUD definition of chronic homelessness. Stopping data collection for 3.917 Prior Living Situation.",
          "readonly_text": "Client stayed 90+ days in an institutional setting. This is considered a \"break\" according to the HUD definition of chronic homelessness.",
          "enable_behavior": "ALL",
          "enable_when": [
            {
              "question": "3.917B.1",
              "operator": "EQUAL",
              "answer_group_code": "INSTITUTIONAL"
            },
            {
              "question": "3.917B.2",
              "operator": "IN",
              "answer_codes": [
                "NUM_90_DAYS_OR_MORE_BUT_LESS_THAN_ONE_YEAR",
                "ONE_YEAR_OR_LONGER"
              ]
            }
          ]
        },
        {
          "type": "DISPLAY",
          "link_id": "3.917B.B.temporary",
          "text": "Client stayed 7+ days in a temporary housing situation. This is considered a \"break\" according to the HUD definition of chronic homelessness. Stopping data collection for 3.917 Prior Living Situation.",
          "readonly_text": "Client stayed 7+ days in a temporary housing situation. This is considered a \"break\" according to the HUD definition of chronic homelessness.",
          "enable_behavior": "ALL",
          "enable_when": [
            {
              "question": "3.917B.1",
              "operator": "EQUAL",
              "answer_group_code": "TEMPORARY"
            },
            {
              "question": "3.917B.2",
              "operator": "IN",
              "answer_codes": [
                "ONE_WEEK_OR_MORE_BUT_LESS_THAN_ONE_MONTH",
                "ONE_MONTH_OR_MORE_BUT_LESS_THAN_90_DAYS",
                "NUM_90_DAYS_OR_MORE_BUT_LESS_THAN_ONE_YEAR",
                "ONE_YEAR_OR_LONGER"
              ]
            }
          ]
        },
        {
          "type": "DISPLAY",
          "link_id": "3.917B.B.permanent",
          "text": "Client stayed 7+ days in a permanent housing situation. This is considered a \"break\" according to the HUD definition of chronic homelessness. Stopping data collection for 3.917 Prior Living Situation.",
          "readonly_text": "Client stayed 7+ days in a permanent housing situation. This is considered a \"break\" according to the HUD definition of chronic homelessness.",
          "enable_behavior": "ALL",
          "enable_when": [
            {
              "question": "3.917B.1",
              "operator": "EQUAL",
              "answer_group_code": "PERMANENT"
            },
            {
              "question": "3.917B.2",
              "operator": "IN",
              "answer_codes": [
                "ONE_WEEK_OR_MORE_BUT_LESS_THAN_ONE_MONTH",
                "ONE_MONTH_OR_MORE_BUT_LESS_THAN_90_DAYS",
                "NUM_90_DAYS_OR_MORE_BUT_LESS_THAN_ONE_YEAR",
                "ONE_YEAR_OR_LONGER"
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "CHOICE",
      "hidden": true,
      "link_id": "3.917B.los-threshold",
      "mapping": {
        "record_type": "ENROLLMENT",
        "field_name": "losUnderThreshold"
      },
      "pick_list_reference": "NoYesMissing",
      "autofill_values": [
        {
          "_comment": "LOS is above the threshold if either of the 'break' display notices are shown",
          "value_code": "NO",
          "autofill_behavior": "ANY",
          "autofill_when": [
            {
              "question": "3.917B.A",
              "operator": "ENABLED"
            },
            {
              "question": "3.917B.B.temporary",
              "operator": "ENABLED"
            },
            {
              "question": "3.917B.B.permanent",
              "operator": "ENABLED"
            }
          ]
        },
        {
          "_comment": "LOS is under the threshold if neither 'break' display notices are shown, AND Living Situation and LOS have both been filled in",
          "value_code": "YES",
          "autofill_behavior": "ALL",
          "autofill_when": [
            {
              "question": "3.917B.2",
              "operator": "EXISTS",
              "answer_boolean": true
            },
            {
              "question": "3.917B.1",
              "operator": "EXISTS",
              "answer_boolean": true
            }
          ]
        },
        {
          "_comment": "LOS is null otherwise",
          "value_code": "DATA_NOT_COLLECTED",
          "autofill_behavior": "ALL",
          "autofill_when": []
        }
      ]
    },
    {
      "type": "CHOICE",
      "link_id": "3.917B.C",
      "required": false,
      "warn_if_empty": true,
      "pick_list_reference": "NoYesMissing",
      "mapping": {
        "record_type": "ENROLLMENT",
        "field_name": "previousStreetEssh"
      },
      "text": "On the night before, did the client stay on the streets, ES or SH?",
      "brief_text": "Homeless on previous night",
      "enable_behavior": "ALL",
      "enable_when": [
        {
          "question": "3.917B.2",
          "operator": "EXISTS",
          "_comment": "LOS has been answered",
          "answer_boolean": true
        },
        {
          "question": "3.917B.2",
          "operator": "NOT_EQUAL",
          "_comment": "LOS has been answered",
          "answer_code": "CLIENT_DOESN_T_KNOW"
        },
        {
          "question": "3.917B.2",
          "operator": "NOT_EQUAL",
          "_comment": "LOS has been answered",
          "answer_code": "CLIENT_PREFERS_NOT_TO_ANSWER"
        },
        {
          "question": "3.917B.2",
          "operator": "NOT_EQUAL",
          "_comment": "LOS has been answered",
          "answer_code": "DATA_NOT_COLLECTED"
        },
        {
          "question": "3.917B.A",
          "operator": "ENABLED",
          "_comment": "threshold message is not shown",
          "answer_boolean": false
        },
        {
          "question": "3.917B.B.temporary",
          "operator": "ENABLED",
          "_comment": "threshold message is not shown",
          "answer_boolean": false
        },
        {
          "question": "3.917B.B.permanent",
          "operator": "ENABLED",
          "_comment": "threshold message is not shown",
          "answer_boolean": false
        }
      ]
    },
    {
      "type": "GROUP",
      "component": "INFO_GROUP",
      "link_id": "3.917B.C.message.group",
      "item": [
        {
          "type": "DISPLAY",
          "link_id": "3.917B.C.message",
          "text": "Client does not meet the HUD definition of chronic homelessness. <br /> Stopping data collection for 3.917 Prior Living Situation.",
          "readonly_text": "Client does not meet the HUD definition of chronic homelessness.",
          "enable_behavior": "ALL",
          "enable_when": [
            {
              "question": "3.917B.C",
              "operator": "EQUAL",
              "_comment": "not homeless on the night before",
              "answer_code": "NO"
            },
            {
              "question": "3.917B.1",
              "operator": "EXISTS",
              "answer_boolean": true
            },
            {
              "question": "3.917B.2",
              "operator": "EXISTS",
              "answer_boolean": true
            },
            {
              "question": "3.917B.A",
              "operator": "ENABLED",
              "answer_boolean": false
            },
            {
              "question": "3.917B.B.temporary",
              "operator": "ENABLED",
              "answer_boolean": false
            },
            {
              "question": "3.917B.B.permanent",
              "operator": "ENABLED",
              "answer_boolean": false
            }
          ]
        }
      ]
    },
    {
      "type": "DATE",
      "link_id": "3.917B.3",
      "required": false,
      "warn_if_empty": true,
      "mapping": {
        "record_type": "ENROLLMENT",
        "field_name": "dateToStreetEssh"
      },
      "text": "Approximate date this episode of homelessness started",
      "enable_behavior": "ALL",
      "enable_when": [
        {
          "question": "3.917B.C",
          "operator": "EQUAL",
          "_comment": "homeless on the night before",
          "answer_code": "YES"
        },
        {
          "question": "3.917B.A",
          "operator": "ENABLED",
          "answer_boolean": false
        },
        {
          "question": "3.917B.B.temporary",
          "operator": "ENABLED",
          "answer_boolean": false
        },
        {
          "question": "3.917B.B.permanent",
          "operator": "ENABLED",
          "answer_boolean": false
        }
      ],
      "bounds": [
        {
          "id": "max-started",
          "type": "MAX",
          "value_local_constant": "$today"
        }
      ]
    },
    {
      "type": "CHOICE",
      "link_id": "3.917B.4",
      "required": false,
      "warn_if_empty": true,
      "mapping": {
        "record_type": "ENROLLMENT",
        "field_name": "timesHomelessPastThreeYears"
      },
      "text": "Regardless of where they stayed last night, number of times the client has been on the streets, in ES, or SH in the past three years including today",
      "brief_text": "Times Homeless",
      "pick_list_reference": "TimesHomelessPastThreeYears",
      "enable_behavior": "ALL",
      "enable_when": [
        {
          "question": "3.917B.A",
          "operator": "ENABLED",
          "answer_boolean": false
        },
        {
          "question": "3.917B.B.temporary",
          "operator": "ENABLED",
          "answer_boolean": false
        },
        {
          "question": "3.917B.B.permanent",
          "operator": "ENABLED",
          "answer_boolean": false
        },
        {
          "question": "3.917B.C",
          "operator": "EQUAL",
          "_comment": "homeless on the night before",
          "answer_code": "YES"
        }
      ]
    },
    {
      "type": "CHOICE",
      "link_id": "3.917B.5",
      "required": false,
      "warn_if_empty": true,
      "mapping": {
        "record_type": "ENROLLMENT",
        "field_name": "monthsHomelessPastThreeYears"
      },
      "text": "Total number of months homeless on the street, in ES, or SH in the past three years",
      "brief_text": "Months Homeless",
      "pick_list_reference": "MonthsHomelessPastThreeYears",
      "enable_behavior": "ALL",
      "enable_when": [
        {
          "question": "3.917B.A",
          "operator": "ENABLED",
          "answer_boolean": false
        },
        {
          "question": "3.917B.B.temporary",
          "operator": "ENABLED",
          "answer_boolean": false
        },
        {
          "question": "3.917B.B.permanent",
          "operator": "ENABLED",
          "answer_boolean": false
        },
        {
          "question": "3.917B.C",
          "operator": "EQUAL",
          "_comment": "homeless on the night before",
          "answer_code": "YES"
        }
      ]
    }
  ]
}