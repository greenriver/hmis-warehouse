{
  "ignored_warnings": [
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "00ff2f7749bdb57cc01b973f02c57dcf6666cbbf0b2f15667bae7db5a56713bd",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/dba/partition_all.rb",
      "line": 26,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"sed -i -e \\\"/self.table_name/a\\\\    self.primary_key = 'id'\\\" #{`#{\"egrep -R 'table_name..*#{t}' drivers/hmis_csv_twenty_twenty_two/app/models/hmis_csv_twenty_twenty_two | cut -d: -f1\"}`}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Dba::PartitionAll",
        "method": "add_explicit_primary_key!"
      },
      "user_input": "`#{\"egrep -R 'table_name..*#{t}' drivers/hmis_csv_twenty_twenty_two/app/models/hmis_csv_twenty_twenty_two | cut -d: -f1\"}`",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "01cec9c5ab9ca358575143a983d74c98a0316ee2bfa87a65f3c5d7c458e3367a",
      "check_name": "Render",
      "message": "Render path contains parameter value",
      "file": "drivers/core_demographics_report/app/views/core_demographics_report/warehouse_reports/core/section.haml",
      "line": 3,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(action => \"core_demographics_report/warehouse_reports/shared/#{params[:partial]}\", {})",
      "render_path": null,
      "location": {
        "type": "template",
        "template": "core_demographics_report/warehouse_reports/core/section"
      },
      "user_input": "params[:partial]",
      "confidence": "Medium",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "023c724508b4c341ebb8aae1c407e91e113c05bccffe0dca58702f276fbe1dd0",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "config/deploy/docker/lib/command_args.rb",
      "line": 34,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "`diff #{path} #{tmppath}`",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "CommandArgs",
        "method": "initialize"
      },
      "user_input": "path",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "07ab3a48e4c84f40fe8acb270d962ed39424807b21c01793b91e44b25acfaf9e",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/grda_warehouse/shape/installer.rb",
      "line": 86,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"./shape_files/#{conf.dir}/make.inserts #{ENV[\"RELEVANT_COC_STATE\"]}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::Shape::Installer",
        "method": "handle_one_geography!"
      },
      "user_input": "conf.dir",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "0a8413f58bac50c36a5c6154a71747e5b6dcc2c7c345f8388fd7d4f42e2350d3",
      "check_name": "SendFile",
      "message": "Model attribute used in file name",
      "file": "app/models/health/scheduled_documents/enrollment_disenrollment.rb",
      "line": 44,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "send_file(:file_name => Health::EnrollmentDisenrollment.new(:start_date => Date.current.beginning_of_month, :end_date => Date.current.end_of_month, :effective_date => Date.current, :aco_ids => acos.reject(&:blank?), :enrollment_reasons => ((Health::EnrollmentReasons.last or Health::EnrollmentReasons.new))).zip_file_name, :data => Zip::OutputStream.write_buffer do\n zio.put_next_entry(Health::EnrollmentDisenrollment.new(:start_date => Date.current.beginning_of_month, :end_date => Date.current.end_of_month, :effective_date => Date.current, :aco_ids => acos.reject(&:blank?), :enrollment_reasons => ((Health::EnrollmentReasons.last or Health::EnrollmentReasons.new))).summary_file_name)\nzio.write(ApplicationController.render(:template => \"warehouse_reports/health/enrollments_disenrollments/summary.xlsx\", :assigns => ({ :report => Health::EnrollmentDisenrollment.new(:start_date => Date.current.beginning_of_month, :end_date => Date.current.end_of_month, :effective_date => Date.current, :aco_ids => acos.reject(&:blank?), :enrollment_reasons => ((Health::EnrollmentReasons.last or Health::EnrollmentReasons.new))) })))\nzio.put_next_entry(Health::EnrollmentDisenrollment.new(:start_date => Date.current.beginning_of_month, :end_date => Date.current.end_of_month, :effective_date => Date.current, :aco_ids => acos.reject(&:blank?), :enrollment_reasons => ((Health::EnrollmentReasons.last or Health::EnrollmentReasons.new))).report_file_name)\nzio.write(ApplicationController.render(:template => \"warehouse_reports/health/enrollments_disenrollments/report.xlsx\", :assigns => ({ :report => Health::EnrollmentDisenrollment.new(:start_date => Date.current.beginning_of_month, :end_date => Date.current.end_of_month, :effective_date => Date.current, :aco_ids => acos.reject(&:blank?), :enrollment_reasons => ((Health::EnrollmentReasons.last or Health::EnrollmentReasons.new))) })))\n end.string)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Health::ScheduledDocuments::EnrollmentDisenrollment",
        "method": "deliver"
      },
      "user_input": "Health::EnrollmentDisenrollment.new(:start_date => Date.current.beginning_of_month, :end_date => Date.current.end_of_month, :effective_date => Date.current, :aco_ids => acos.reject(&:blank?), :enrollment_reasons => ((Health::EnrollmentReasons.last or Health::EnrollmentReasons.new))).report_file_name",
      "confidence": "Weak",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "0af0024667b7b016cd20c0283221da1380c57b59de7f31758007777193b6bae8",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/grda_warehouse/hud/project.rb",
      "line": 383,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "where(\"#{access_to_project_through_viewable_entities(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)} OR #{access_to_project_through_organization(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)} OR #{access_to_project_through_data_source(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)} OR #{access_to_project_through_coc_codes(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)} OR #{access_to_project_through_project_access_groups(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Project",
        "method": null
      },
      "user_input": "access_to_project_through_viewable_entities(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "0ea2018506ebfda99646143c3a6b329586df8a0a0b9ad12049e05c90566f6d22",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/grda_warehouse/us_census_api/is_a_database_view.rb",
      "line": 41,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.exec_query(\"DROP #{materialized} VIEW IF EXISTS #{@view_name};\\n\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::UsCensusApi::IsADatabaseView::ClassMethods",
        "method": "drop!"
      },
      "user_input": "materialized",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": "Injection from internal sources"
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "0fc8bda3aa0534d15b8341980b3cd903e10cf9bf203e38eb3abbc26ff6b5c0c2",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/grda_warehouse/lftp_s3_sync.rb",
      "line": 55,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"echo #{lftp_bookmark} > #{lftp_bookmark_location}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::LftpS3Sync",
        "method": "set_lftp_bookmark"
      },
      "user_input": "lftp_bookmark",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "13a7f90845cffdc12900858d9d2d0e853dcd03c123ae71ebfe37e725f6d6453a",
      "check_name": "FileAccess",
      "message": "Parameter value used in file name",
      "file": "drivers/client_access_control/app/controllers/client_access_control/history_controller.rb",
      "line": 119,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "File.open(Rails.root.join(\"tmp\", \"service_history_pdf_#{::GrdaWarehouse::Hud::Client.destination.find(params[:client_id].to_i).id}.pdf\"), \"wb\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ClientAccessControl::HistoryController",
        "method": "pdf"
      },
      "user_input": "params[:client_id]",
      "confidence": "Weak",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "13d40d39bffa94f44c6f95387fdabf76e416286b0719000122e9aef86aa19737",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/grda_warehouse/shape/zip_code.rb",
      "line": 84,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.execute(\"UPDATE\\n  shape_zip_codes AS z\\nSET\\n  county_name_lower = LOWER(namelsad)\\nFROM\\n  shape_counties c\\nWHERE\\n  z.county_name_lower IS NULL\\n  AND z.st_geoid = '#{state_code}'\\n  AND\\n    (\\n      ST_Area(ST_Intersection(z.geom, c.geom))\\n      /\\n      ST_Area(z.geom)\\n      >\\n      0.95\\n    )\\n\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::Shape::ZipCode",
        "method": "GrdaWarehouse::Shape::ZipCode.calculate_counties"
      },
      "user_input": "state_code",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "149f43ca0c9d46c20323967d168bcf5e5dc81816dd870fc6ce1cd8f047d79639",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/bi/view_maintainer.rb",
      "line": 398,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "GrdaWarehouseBase.connection.execute(\"DROP VIEW IF EXISTS #{name}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Bi::ViewMaintainer",
        "method": "safe_drop_view"
      },
      "user_input": "name",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "150ecb715f71e17ac9457b3b0a5a938f6c8023af3e2199132fce57d1e6c60309",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/rds_sql_server/lsa_summary.rb",
      "line": 475,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "SqlServerBase.connection.exec_query(\"dbo.sp_lsaPersonDemographics #{pop[:pop_id]}, #{(hh_type or \"NULL\")}, '#{param}'\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "LsaSqlServer::LSAReportSummary",
        "method": "fetch_demographics"
      },
      "user_input": "pop[:pop_id]",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "1547f3e0a337f1a7b198be3c3c47ebeba2160c2565c27f2fce794f2c5775535f",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/grda_warehouse/us_census_api/is_a_database_view.rb",
      "line": 27,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.exec_query(\"CREATE #{materialized} VIEW #{@view_name} AS\\n#{view_definition}\\n\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::UsCensusApi::IsADatabaseView::ClassMethods",
        "method": "rebuild!"
      },
      "user_input": "materialized",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": "Injection from internal sources"
    },
    {
      "warning_type": "Remote Code Execution",
      "warning_code": 24,
      "fingerprint": "167d304a2a6e35f5514e9151322701f7330f801e1b29f03e072fadc7e6e35dae",
      "check_name": "UnsafeReflection",
      "message": "Unsafe reflection method `constantize` called on model attribute",
      "file": "app/jobs/warehouse_reports/dashboard_report_job.rb",
      "line": 14,
      "link": "https://brakemanscanner.org/docs/warning_types/remote_code_execution/",
      "code": "GrdaWarehouse::WarehouseReports::Dashboard::Base.sub_populations_by_type[report_type.to_sym][sub_population.to_sym].constantize",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "WarehouseReports::DashboardReportJob",
        "method": "perform"
      },
      "user_input": "GrdaWarehouse::WarehouseReports::Dashboard::Base.sub_populations_by_type[report_type.to_sym]",
      "confidence": "Medium",
      "cwe_id": [
        470
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "17b51608f07889a142d8f548bbe24583b3bab7d8146caeedc9ad2c7e9ad1d2bf",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/bi/view_maintainer.rb",
      "line": 418,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "GrdaWarehouseBase.connection.execute(\"CREATE OR REPLACE VIEW #{name} AS #{sql_definition}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Bi::ViewMaintainer",
        "method": "safe_create_view"
      },
      "user_input": "name",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "18a6f39c30bf1ec1d965f076562af5578472b944d2e7324025e393523c8f03e2",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/grda_warehouse/lftp_s3_sync.rb",
      "line": 66,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"echo 'set mirror:exclude-regex ^[.b]+' >> #{lftp_config_location}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::LftpS3Sync",
        "method": "set_lftp_confg"
      },
      "user_input": "lftp_config_location",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "194ffcfbbfb5dad65d6c2cd5fc8e010479f66a6251142ec091dc5436f8205abe",
      "check_name": "Render",
      "message": "Render path contains parameter value",
      "file": "app/views/imports/show.haml",
      "line": 1,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(action => import_scope.find(params.require(:id)), {})",
      "render_path": [
        {
          "type": "controller",
          "class": "ImportsController",
          "method": "show",
          "line": 23,
          "file": "app/controllers/imports_controller.rb",
          "rendered": {
            "name": "imports/show",
            "file": "app/views/imports/show.haml"
          }
        }
      ],
      "location": {
        "type": "template",
        "template": "imports/show"
      },
      "user_input": "params.require(:id)",
      "confidence": "Weak",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "19b0be47dc59be902eb1e0500e9fba29ccf43752f0eb56a2180a222af552ceb0",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 89,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "served(period).where(\"#{period}_period_inactive\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Client",
        "method": null
      },
      "user_input": "period",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "19c3fe8a852b93bcbe76a2c538efd1bd4f415d54be801c0dea33174d4f297668",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/rds_sql_server/lsa/fy2022/lsa_queries.rb",
      "line": 82,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "SqlServerBase.connection.execute((\"-- 4.1 Get Project Records for Export\\ndelete from lsa_Project\\n\\ninsert into lsa_Project\\n  (ProjectID, OrganizationID, ProjectName\\n  , OperatingStartDate, OperatingEndDate\\n  , ContinuumProject, ProjectType, HousingType\\n  , TrackingMethod, HMISParticipatingProject\\n  , TargetPopulation\\n  , HOPWAMedAssistedLivingFac\\n  , DateCreated, DateUpdated, ExportID)\\nselect distinct\\n  hp.ProjectID, hp.OrganizationID, left(hp.ProjectName, 100)\\n  , format(hp.OperatingStartDate, 'yyyy-MM-dd')\\n  , case when hp.OperatingEndDate is not null then format(hp.OperatingEndDate, 'yyyy-MM-dd') else null end\\n  , hp.ContinuumProject, hp.ProjectType, hp.HousingType\\n  , hp.TrackingMethod, hp.HMISParticipatingProject\\n  , hp.TargetPopulation\\n  , hp.HOPWAMedAssistedLivingFac\\n  , format(hp.DateCreated, 'yyyy-MM-dd hh:mm:ss')\\n  , format(hp.DateUpdated, 'yyyy-MM-dd hh:mm:ss')\\n  , rpt.ReportID\\nfrom hmis_Project hp\\ninner join lsa_Report rpt on hp.OperatingStartDate <= rpt.ReportEnd\\ninner join hmis_ProjectCoC coc on coc.CoCCode = rpt.ReportCoC\\n  and coc.ProjectID = hp.ProjectID\\n  and coc.DateDeleted is null\\nwhere hp.DateDeleted is null\\n  and hp.ContinuumProject = 1\\n  and hp.ProjectType in (1,2,3,8,9,10,13)\\n  and hp.OperatingStartDate <= rpt.ReportEnd\\n  and (hp.OperatingEndDate is null\\n    or\\t(hp.OperatingEndDate >= '10/1/2012'\\n      and hp.OperatingEndDate > hp.OperatingStartDate)\\n    )\\n\" + \"and hp.ProjectID in(#{project_ids.join(\",\")})\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "LsaSqlServer::LSAQueries",
        "method": "insert_projects"
      },
      "user_input": "project_ids.join(\",\")",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "1ac799c533aadef8fe47464b7d13b7194917e146920bf3046c57c2f22e03e255",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 77,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "served(period).where(\"#{period}_period_first_time\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Client",
        "method": null
      },
      "user_input": "period",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "1df4a1869c415ff591772486343b6515afd1635cc8320e99dff0ec4d575c5583",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/grda_warehouse/service_history_service.rb",
      "line": 149,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.execute(\"select count(*) from information_schema.triggers where trigger_name = '#{trigger_name}'\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::ServiceHistoryService",
        "method": "GrdaWarehouse::ServiceHistoryService.trigger_exists?"
      },
      "user_input": "trigger_name",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "25d28895cd8c28107ce7787e8a0d20c3123f46547dcb6a29559bb11780b3c84e",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/rds_sql_server/lsa/fy2022/lsa_queries.rb",
      "line": 25,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "SqlServerBase.connection.execute(\"#{File.read(step)}\\n\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "LsaSqlServer::LSAQueries",
        "method": "run_query"
      },
      "user_input": "File.read(step)",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "272bd9135442f395012a87ac47a02fe2dcaa8bf8f7db7b78b079036a4279e439",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "config/deploy/docker/lib/ecs_tools.rb",
      "line": 25,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"ssh #{\"ecs0.openpath.host\"} 'docker commit #{`ssh #{\"ecs0.openpath.host\"} \"docker ps -a -n 10\"`.split(/\\n/).grep(/#{IMAGE}/).first.split(/\\s/).first} shell'\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "EcsTools",
        "method": "shell"
      },
      "user_input": "`ssh #{\"ecs0.openpath.host\"} \"docker ps -a -n 10\"`.split(/\\n/).grep(/#{IMAGE}/).first.split(/\\s/).first",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "2bf0a30baca275e9fa8c2b29b1d73e2238386744deb142c7beed0d3c09e243c7",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 18,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "spm_leaver(period).where(\"#{period}_period_days_to_return\" => (1..731))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PerformanceMetrics::Client",
        "method": "returned_in_two_years"
      },
      "user_input": "period",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "2d5a0735c8eef436174e943c26f2f3107fdbe465dd46e480ad60ed6b43b29b5b",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/grda_warehouse/lftp_s3_sync.rb",
      "line": 70,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"rm -rf #{lftp_bookmark_path}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::LftpS3Sync",
        "method": "remove_lftp_bookmark"
      },
      "user_input": "lftp_bookmark_path",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "2d9e2650f0d201448eb48c3fe30e82042060f478c362cd5c9addce551f8707f2",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/grda_warehouse/lftp_s3_sync.rb",
      "line": 42,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"mkdir -p #{tmp_destination}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::LftpS3Sync",
        "method": "ensure_tmp_destination"
      },
      "user_input": "tmp_destination",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "2e16f45ec183ad1ea6f792c533e77535a7542d5c57e2a3987b2653445fa404fd",
      "check_name": "Render",
      "message": "Render path contains parameter value",
      "file": "drivers/boston_reports/app/views/boston_reports/warehouse_reports/street_to_homes/section.haml",
      "line": 3,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(action => params[:partial], {})",
      "render_path": null,
      "location": {
        "type": "template",
        "template": "boston_reports/warehouse_reports/street_to_homes/section"
      },
      "user_input": "params[:partial]",
      "confidence": "High",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "34fd658393a9fb9bf9452d6dafc2a7dea87444ddd212196aef05e44065feeeb8",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/grda_warehouse/lftp_s3_sync.rb",
      "line": 47,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"rm -rf #{tmp_destination}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::LftpS3Sync",
        "method": "remove_tmp_destination"
      },
      "user_input": "tmp_destination",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Cross-Site Scripting",
      "warning_code": 2,
      "fingerprint": "36b35863c16487c4b159e6256376dc53950282919cf2d0e6ecdc46f3752e0924",
      "check_name": "CrossSiteScripting",
      "message": "Unescaped model attribute",
      "file": "app/views/account_two_factors/show.haml",
      "line": 8,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "current_user.generate_otp_backup_codes!.join(\"<br />\")",
      "render_path": [
        {
          "type": "controller",
          "class": "AccountTwoFactorsController",
          "method": "show",
          "line": 21,
          "file": "app/controllers/account_two_factors_controller.rb",
          "rendered": {
            "name": "account_two_factors/show",
            "file": "app/views/account_two_factors/show.haml"
          }
        }
      ],
      "location": {
        "type": "template",
        "template": "account_two_factors/show"
      },
      "user_input": "current_user.generate_otp_backup_codes!.join(\"<br />\")",
      "confidence": "Weak",
      "cwe_id": [
        79
      ],
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "39fbe5b21264364680753579cfb9bbfa2a05b5af5e3646dbe3bdcd6c65579db5",
      "check_name": "Render",
      "message": "Render path contains parameter value",
      "file": "app/controllers/data_quality_reports_controller.rb",
      "line": 27,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(action => report_scope.where(:project_id => params[:project_id].to_i).find(params[:id].to_i).model_name.element.to_sym, {})",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "DataQualityReportsController",
        "method": "show"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "3c34148ef3e1480d75ca0f84d0903a2c26b9006b0a35bb5a2ea4ef7aaa7a2500",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 37,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "served(period).where(\"#{period}_period_entering_housing\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PerformanceMetrics::Client",
        "method": "entering_housing"
      },
      "user_input": "period",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "3e7e0291a50a229015f6e9674412dd30aaa687e973bc11e005d95406444e97d9",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 29,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "served(period).where(\"#{period}_period_caper_leaver\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PerformanceMetrics::Client",
        "method": "caper_leaver"
      },
      "user_input": "period",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "3ea612cf8f87c4df2fb19b416feb0917b443306a55319ddf1d6978b79dedeaea",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/grda_warehouse/lftp_s3_sync.rb",
      "line": 87,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"lftp -c \\\"open #{slug}; lcd #{tmp_destination}; mirror --verbose --exclude tmp\\\"\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::LftpS3Sync",
        "method": "fetch"
      },
      "user_input": "slug",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "473ca8588df62336dd0e01e2d9695c7643b543e986c48cadceb7641d2acd2e25",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 18,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "spm_leaver(period).where(\"#{period}_period_days_to_return\" => (1..731))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Client",
        "method": null
      },
      "user_input": "period",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "4a796237555b5c06d7a008fb5b55bce0a0c6666a643b6432a8ae45039c597573",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_measurement/app/models/performance_measurement/result_calculation.rb",
      "line": 128,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "clients.joins(:client_projects).merge(PerformanceMeasurement::ClientProject.where(:period => period, :for_question => field).where.not(:project_id => nil)).group(:project_id).sum(\"#{period}_#{field}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PerformanceMeasurement::ResultCalculation",
        "method": "client_sum"
      },
      "user_input": "period",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "4dbef2124ce5f88d9517b90cfd0933fa92ca9a4353331c92fca66c397e476a6f",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 77,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "served(period).where(\"#{period}_period_first_time\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PerformanceMetrics::Client",
        "method": "first_time"
      },
      "user_input": "period",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Remote Code Execution",
      "warning_code": 24,
      "fingerprint": "4e32d94cd0b8fcac6d4712e6929fe5a68f0bd56e687fb670d5174063895c443e",
      "check_name": "UnsafeReflection",
      "message": "Unsafe reflection method `constantize` called on model attribute",
      "file": "app/models/importers/hmis_auto_migrate.rb",
      "line": 33,
      "link": "https://brakemanscanner.org/docs/warning_types/remote_code_execution/",
      "code": "available_migrations[((AutoEncodingCsv.read(\"#{csv_dir}/Export.csv\", :headers => true).first.to_h or {})[\"csvversion\"] or \"2020\")].constantize",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Importers::HmisAutoMigrate",
        "method": "Importers::HmisAutoMigrate.apply_migrations"
      },
      "user_input": "AutoEncodingCsv.read(\"#{csv_dir}/Export.csv\", :headers => true).first",
      "confidence": "Medium",
      "cwe_id": [
        470
      ],
      "note": ""
    },
    {
      "warning_type": "Cross-Site Scripting",
      "warning_code": 2,
      "fingerprint": "51ec304bfb996e9d40ff69207ead86771b77a085b4a1bee4454fa4821f70fa70",
      "check_name": "CrossSiteScripting",
      "message": "Unescaped model attribute",
      "file": "app/views/supplemental_enrollment_datum/_default.haml",
      "line": 7,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "markdown.render(GrdaWarehouse::Config.active_supplemental_enrollment_importer_class.describe)",
      "render_path": null,
      "location": {
        "type": "template",
        "template": "supplemental_enrollment_datum/_default"
      },
      "user_input": "GrdaWarehouse::Config.active_supplemental_enrollment_importer_class.describe",
      "confidence": "Weak",
      "cwe_id": [
        79
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "5499b637b8348aa1e36c39c76eedd901c66563518a8514361499efb75c9b0b43",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/jobs/worker_status.rb",
      "line": 114,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "`curl #{ENV[\"ECS_CONTAINER_METADATA_URI_V4\"]}/task`",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "WorkerStatus",
        "method": "task_metadata"
      },
      "user_input": "ENV[\"ECS_CONTAINER_METADATA_URI_V4\"]",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": "Considering AWS provided URI okay to inject"
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "560654d4119023b98ace9aa621f8578d4bbf9842e89acc251bda37a3ca2476ab",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/concerns/reporting/project_data_quality_reports/version_four/display.rb",
      "line": 1193,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "send(options[:denominator]).where(\"#{key}_#{measure}\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reporting::ProjectDataQualityReports::VersionFour::Display",
        "method": "project_group_completeness"
      },
      "user_input": "key",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "5bc404c91fe46e9bbcfd3cd9bdca6c45a1bd7fb89281f8a8fda56fc1da2ff876",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "config/deploy/docker/lib/deployer.rb",
      "line": 116,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "`git rev-parse #{`git rev-parse --abbrev-ref HEAD`.chomp}`",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Deployer",
        "method": "s(:self).check_that_you_pushed_to_remote!"
      },
      "user_input": "`git rev-parse --abbrev-ref HEAD`.chomp",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "5e218500963e50340c098eba0301ff524fef605cfe646cc30739c101b587d0af",
      "check_name": "Render",
      "message": "Render path contains parameter value",
      "file": "drivers/disability_summary/app/views/disability_summary/warehouse_reports/disability_summary/section.haml",
      "line": 3,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(action => params[:partial], {})",
      "render_path": null,
      "location": {
        "type": "template",
        "template": "disability_summary/warehouse_reports/disability_summary/section"
      },
      "user_input": "params[:partial]",
      "confidence": "High",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "Remote Code Execution",
      "warning_code": 24,
      "fingerprint": "5f663e1330e1986e8d398745960c0bc7d3b81ecec41fbb3da180f7eed7495c70",
      "check_name": "UnsafeReflection",
      "message": "Unsafe reflection method `constantize` called on parameter value",
      "file": "app/controllers/data_sources/custom_imports_controller.rb",
      "line": 19,
      "link": "https://brakemanscanner.org/docs/warning_types/remote_code_execution/",
      "code": "config_scope.find(params[:id].to_i).import_type.constantize",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "DataSources::CustomImportsController",
        "method": "show"
      },
      "user_input": "params[:id]",
      "confidence": "Medium",
      "cwe_id": [
        470
      ],
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "6012356b03eb94bac6208d03adf39acd1db517d644ec8c52e503b7efef462571",
      "check_name": "Render",
      "message": "Render path contains parameter value",
      "file": "app/views/health/goals/edit.haml",
      "line": 4,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(action => ::Health::Goal::Hpc.find(params[:id].to_i), { :readonly => false })",
      "render_path": [
        {
          "type": "controller",
          "class": "Health::GoalsController",
          "method": "edit",
          "line": 34,
          "file": "app/controllers/concerns/health_goal.rb",
          "rendered": {
            "name": "health/goals/edit",
            "file": "app/views/health/goals/edit.haml"
          }
        }
      ],
      "location": {
        "type": "template",
        "template": "health/goals/edit"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "615f7900b129c22f4d71c443ead85e0694fc30435dfdc15e52ec03a94d2a3057",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "config/deploy/docker/lib/ecs_tools.rb",
      "line": 38,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "exec(\"awslogs get #{group} ALL --watch\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "EcsTools",
        "method": "logs"
      },
      "user_input": "group",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "6463026c70cc0039bae21ca8e37fbd46172778b151ae4813a5a1e469a700b357",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/rds_sql_server/rds.rb",
      "line": 251,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "SqlServerBootstrapModel.connection.execute(\"if not exists(select * from sys.databases where name = '#{database}')\\n  select 0;\\nelse\\n  select 1;\\n\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Rds",
        "method": "db_exists?"
      },
      "user_input": "database",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "68fd80799149a697286de5a354b66c0875731d4db0137099d29dd53d6a4533ee",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/report_generators/lsa/fy2021/all.rb",
      "line": 660,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "SqlServerBase.connection.execute((\"\" + \" ALTER TABLE #{table_name} ADD id BIGINT identity (1,1) NOT NULL; \"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ReportGenerators::Lsa::Fy2021::All",
        "method": "add_missing_identity_columns"
      },
      "user_input": "table_name",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "6e5df3b3f5ce952da511bebf27d22c40e0a934348f52d15ee653240ab652ce9b",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 14,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "where(\"include_in_#{period}_period\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Client",
        "method": null
      },
      "user_input": "period",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Cross-Site Scripting",
      "warning_code": 2,
      "fingerprint": "70b70b984f26e96e4c136d1371587575175b3f7e6e7cb0c597f1a73c7cd9f781",
      "check_name": "CrossSiteScripting",
      "message": "Unescaped parameter value",
      "file": "app/views/warehouse_reports/chronic_housed/index.haml",
      "line": 40,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "site_chronic_source.where(:date => ::Filters::DateRange.new((params.permit(:range => ([:start, :end]))[:range] or { :start => 3.month.ago.to_date, :end => 1.months.ago.to_date })).range).group_by(&:client_id)[exits.first.client_id].map(&:date).uniq.join(\"<br />\")",
      "render_path": [
        {
          "type": "controller",
          "class": "WarehouseReports::ChronicHousedController",
          "method": "index",
          "line": 17,
          "file": "app/controllers/warehouse_reports/chronic_housed_controller.rb",
          "rendered": {
            "name": "warehouse_reports/chronic_housed/index",
            "file": "app/views/warehouse_reports/chronic_housed/index.haml"
          }
        }
      ],
      "location": {
        "type": "template",
        "template": "warehouse_reports/chronic_housed/index"
      },
      "user_input": "params.permit(:range => ([:start, :end]))[:range]",
      "confidence": "Weak",
      "cwe_id": [
        79
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "70c7d5e56f2aae7f8a1be7e25ea15fb31cb39d725235fad7940bb8e4a2840a25",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/grda_warehouse/shape/shared_behaviors.rb",
      "line": 52,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "Arel.sql(\"simplified_geom = ST_MakeValid(ST_Simplify(geom, #{simplification_distance_in_degrees}))\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::Shape::SharedBehaviors::ClassMethods",
        "method": "simplify!"
      },
      "user_input": "simplification_distance_in_degrees",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": "Injection from internal sources"
    },
    {
      "warning_type": "Cross-Site Scripting",
      "warning_code": 2,
      "fingerprint": "71fcba957e924214d21f72cc0437daccd8704cf71ff85e186ae831b36dc62423",
      "check_name": "CrossSiteScripting",
      "message": "Unescaped model attribute",
      "file": "app/views/health/sdh_case_management_notes/edit.haml",
      "line": 7,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "[Health::QualifyingActivityV1, Health::QualifyingActivityV2].map(&:js_model).join(\", \")",
      "render_path": [
        {
          "type": "controller",
          "class": "Health::SdhCaseManagementNotesController",
          "method": "edit",
          "line": 43,
          "file": "app/controllers/health/sdh_case_management_notes_controller.rb",
          "rendered": {
            "name": "health/sdh_case_management_notes/edit",
            "file": "app/views/health/sdh_case_management_notes/edit.haml"
          }
        }
      ],
      "location": {
        "type": "template",
        "template": "health/sdh_case_management_notes/edit"
      },
      "user_input": "[Health::QualifyingActivityV1, Health::QualifyingActivityV2].map(&:js_model)",
      "confidence": "Weak",
      "cwe_id": [
        79
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "781aac46e7b1378f886f2b9f429b4b36766b82a3ce2c8453f8be825781ea49b5",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/glacier/runner.rb",
      "line": 37,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"psql -d postgres --username=#{db_user} --no-password --host=#{(provided_db_host or db_host)} -c 'create database #{database_name}'\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Glacier::Runner",
        "method": "restore_database!"
      },
      "user_input": "db_user",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "7b07960e8183fd903d2b5da2531174a58e52432690e67a5e83a5db857acdf1e2",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/client_access_control/app/controllers/client_access_control/search_concern.rb",
      "line": 43,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ClientAccessControl::SearchConcern",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "7c23c32e38cb863eb92c15f8db6f7c142ce3245181ee3c751a89326541deb11c",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/report_generators/lsa/fy2021/all.rb",
      "line": 391,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "SqlServerBase.connection.execute(\"drop database #{@rds.database}\\n\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ReportGenerators::Lsa::Fy2021::All",
        "method": "remove_temporary_rds"
      },
      "user_input": "@rds.database",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "7c66a105e2dc82603b638726429867081fd7bdfc09b716d4699dcf62401a11e6",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/concerns/reporting/project_data_quality_reports/version_four/display.rb",
      "line": 1225,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "send(options[:denominator]).where(:project_id => hud_project.id, \"#{key}_#{measure}\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reporting::ProjectDataQualityReports::VersionFour::Display",
        "method": "project_completeness"
      },
      "user_input": "key",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "7cf7ec040c7558f045aaf989290c0d7d8e6b87e9e9a2ad2b31455b0a54390da8",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 37,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "served(period).where(\"#{period}_period_entering_housing\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Client",
        "method": null
      },
      "user_input": "period",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "7cf7ec040c7558f045aaf989290c0d7d8e6b87e9e9a2ad2b31455b0a54390da8",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 85,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "served(period).where(\"#{period}_period_entering_housing\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Client",
        "method": null
      },
      "user_input": "period",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "7e17f63fe0ee996de8b8f7dde5a7277c192d0bb19ea27c0ecc07f80ffdb4154c",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/report_generators/lsa/fy2019/all.rb",
      "line": 379,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "SqlServerBase.connection.execute(\"drop database #{@rds.database}\\n\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ReportGenerators::Lsa::Fy2019::All",
        "method": "remove_temporary_rds"
      },
      "user_input": "@rds.database",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "7e53cd57f540fbff8b4b9ca11202d8504298e65c5969ae454a967b5fdb136eca",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 81,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "served(period).where(\"#{period}_period_reentering\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Client",
        "method": null
      },
      "user_input": "period",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "7ee61548049f61b1a03ccb384025d6f756bbfbc9dd16bfe279def805e0a66088",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 57,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "served(period).where(\"#{period}_period_in_outflow\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PerformanceMetrics::Client",
        "method": "in_outflow"
      },
      "user_input": "period",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "81569b028ce6ab31f73fb93a21bf6620a32d747e1c75beaf145a0589b6579058",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/report_generators/lsa/fy2019/all.rb",
      "line": 659,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "SqlServerBase.connection.execute((\"\" + \" ALTER TABLE #{table_name} DROP COLUMN id; \"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ReportGenerators::Lsa::Fy2019::All",
        "method": "remove_missing_identity_columns"
      },
      "user_input": "table_name",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "81a65b32220691216fa87c01555fcbc700ac9c5082327613c6c53576518e47c4",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/dba/database_bloat.rb",
      "line": 142,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"pg_repack #{\"--no-superuser-check -U #{ar_base_class.connection_db_config.configuration_hash[:username]} -d #{ar_base_class.connection_db_config.configuration_hash[:database]} -h #{(CGI.escape(ar_base_class.connection_db_config.configuration_hash[:host]) or ar_base_class.connection_db_config.configuration_hash[:host])} -p #{(ar_base_class.connection_db_config.configuration_hash[:port] or \"5432\")} -t #{row[\"schemaname\"]}.#{row[\"tblname\"]}\"}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Dba::DatabaseBloat",
        "method": "repack!"
      },
      "user_input": "ar_base_class.connection_db_config.configuration_hash[:username]",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "81e2b0d48a2dbe0a092252cf247638254bc6b7f2b6c876600d4edbd6102b7c72",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/grda_warehouse/shape/shared_behaviors.rb",
      "line": 57,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "where(:full_geoid => nil).update_all(\"full_geoid = '#{Arel.sql(_full_geoid_prefix)}' || 'US' || #{_geoid_column}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::Shape::SharedBehaviors::ClassMethods",
        "method": "set_full_geoid!"
      },
      "user_input": "Arel.sql(_full_geoid_prefix)",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": "Injection from internal sources"
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "8209c231f3717f00dfbf5f1ae66d9b27926d43b14bc03133faed58d17aa086e6",
      "check_name": "FileAccess",
      "message": "Parameter value used in file name",
      "file": "drivers/client_access_control/app/controllers/client_access_control/history_controller.rb",
      "line": 122,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "File.open(Rails.root.join(\"tmp\", \"service_history_pdf_#{::GrdaWarehouse::Hud::Client.destination.find(params[:client_id].to_i).id}.pdf\"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ClientAccessControl::HistoryController",
        "method": "pdf"
      },
      "user_input": "params[:client_id]",
      "confidence": "Weak",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "Remote Code Execution",
      "warning_code": 24,
      "fingerprint": "82e659e3c26b016652cb4f7b2ff4b27a0ecc1e24e74af02de95ac355d080738e",
      "check_name": "UnsafeReflection",
      "message": "Unsafe reflection method `constantize` called on model attribute",
      "file": "drivers/hmis/app/graphql/mutations/submit_form.rb",
      "line": 21,
      "link": "https://brakemanscanner.org/docs/warning_types/remote_code_execution/",
      "code": "Hmis::Form::Definition.find_by(:id => input.form_definition_id).record_class_name.constantize",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Mutations::SubmitForm",
        "method": "resolve"
      },
      "user_input": "Hmis::Form::Definition.find_by(:id => input.form_definition_id).record_class_name",
      "confidence": "Medium",
      "cwe_id": [
        470
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "850068cbcbd30e554efc5cc597f03ad14dfbd68240142d37a64e9f7a6c53a1a7",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/grda_warehouse/lftp_s3_sync.rb",
      "line": 63,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"mkdir -p #{lftp_bookmark_path}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::LftpS3Sync",
        "method": "set_lftp_confg"
      },
      "user_input": "lftp_bookmark_path",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "85283b166eb4bcf02cc87be10e06c2d8433300155419b05dc24758732632d3ce",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/grda_warehouse/hud/organization.rb",
      "line": 90,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "where(\"#{has_access_to_organization_through_viewable_entities(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)} OR #{has_access_to_organization_through_data_source(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Organization",
        "method": null
      },
      "user_input": "has_access_to_organization_through_viewable_entities(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "8580f942d43b807a8fe09fbd4c5e9ab5db0028e8c4d4288fd2657ade3cace20e",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/client_location_history/app/controllers/client_location_history/clients_controller.rb",
      "line": 43,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ClientLocationHistory::ClientsController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "8580f942d43b807a8fe09fbd4c5e9ab5db0028e8c4d4288fd2657ade3cace20e",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/client_location_history/app/controllers/client_location_history/clients_controller.rb",
      "line": 48,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ClientLocationHistory::ClientsController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "8580f942d43b807a8fe09fbd4c5e9ab5db0028e8c4d4288fd2657ade3cace20e",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/client_location_history/app/controllers/client_location_history/clients_controller.rb",
      "line": 63,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ClientLocationHistory::ClientsController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "8580f942d43b807a8fe09fbd4c5e9ab5db0028e8c4d4288fd2657ade3cace20e",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/client_location_history/app/controllers/client_location_history/clients_controller.rb",
      "line": 69,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ClientLocationHistory::ClientsController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "8580f942d43b807a8fe09fbd4c5e9ab5db0028e8c4d4288fd2657ade3cace20e",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/client_location_history/app/controllers/client_location_history/clients_controller.rb",
      "line": 73,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ClientLocationHistory::ClientsController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "85e335c4575b12b61263ca6d933cb810fe5f86ad44c5f53e83e8558af7897a58",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "config/deploy/docker/lib/deployer.rb",
      "line": 115,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "`git ls-remote origin | grep refs/heads/#{`git rev-parse --abbrev-ref HEAD`.chomp}$`",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Deployer",
        "method": "s(:self).check_that_you_pushed_to_remote!"
      },
      "user_input": "`git rev-parse --abbrev-ref HEAD`.chomp",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "88ba6947358eb613f838a50fc8a1b137f655dda08126594643d90dca1df7daa9",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/grda_warehouse/hud/organization.rb",
      "line": 65,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "where(\"#{has_access_to_organization_through_viewable_entities(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)} OR #{has_access_to_organization_through_data_source(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)} OR #{has_access_to_organization_through_projects(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Organization",
        "method": null
      },
      "user_input": "has_access_to_organization_through_viewable_entities(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "8a29ddebc189081add6710e179967e490ad042f12df9fdfaac8211e87e8d97db",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "config/deploy/docker/lib/deployer.rb",
      "line": 337,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "`docker image ls -f 'reference=#{repo_name}' | grep \"#{_ruby_version}-#{_pre_cache_version}--pre-cache\"`",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Deployer",
        "method": "_pre_cache_image_exists?"
      },
      "user_input": "repo_name",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "90ff2d536c66b271d5f9e428f8f430887e06ca4bf3031ede5a3846d9f7c12294",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/report_generators/lsa/fy2019/all.rb",
      "line": 650,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "SqlServerBase.connection.execute((\"\" + \" ALTER TABLE #{table_name} ADD id BIGINT identity (1,1) NOT NULL; \"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ReportGenerators::Lsa::Fy2019::All",
        "method": "add_missing_identity_columns"
      },
      "user_input": "table_name",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "94f0e64c5acc071a901163d39ebce6861e109a286a0157b979408b31ce9c6a17",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/grda_warehouse/data_source.rb",
      "line": 89,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "where(\"#{has_access_to_data_source_through_viewable_entities(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)} OR #{has_access_to_data_source_through_organizations(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)} OR #{has_access_to_data_source_through_projects(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::DataSource",
        "method": null
      },
      "user_input": "has_access_to_data_source_through_viewable_entities(user, lambda do\n connection.quote(s)\n end, lambda do\n connection.quote_column_name(s)\n end)",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "9692613627d688f403a35e4849b3124d0777a54374a6433aeeddc593711e2e19",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/service_scanning/app/controllers/service_scanning/scanner_ids_controller.rb",
      "line": 43,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ServiceScanning::ScannerIdsController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "9692613627d688f403a35e4849b3124d0777a54374a6433aeeddc593711e2e19",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/service_scanning/app/controllers/service_scanning/scanner_ids_controller.rb",
      "line": 48,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ServiceScanning::ScannerIdsController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "9692613627d688f403a35e4849b3124d0777a54374a6433aeeddc593711e2e19",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/service_scanning/app/controllers/service_scanning/scanner_ids_controller.rb",
      "line": 63,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ServiceScanning::ScannerIdsController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "9692613627d688f403a35e4849b3124d0777a54374a6433aeeddc593711e2e19",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/service_scanning/app/controllers/service_scanning/scanner_ids_controller.rb",
      "line": 69,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ServiceScanning::ScannerIdsController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "9692613627d688f403a35e4849b3124d0777a54374a6433aeeddc593711e2e19",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/service_scanning/app/controllers/service_scanning/scanner_ids_controller.rb",
      "line": 73,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ServiceScanning::ScannerIdsController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Remote Code Execution",
      "warning_code": 24,
      "fingerprint": "a018a2a65716f162e78639cf9ecc84440e48c1b4001c80db96d96f5ca82c11ab",
      "check_name": "UnsafeReflection",
      "message": "Unsafe reflection method `constantize` called on model attribute",
      "file": "app/controllers/cohorts/clients_controller.rb",
      "line": 466,
      "link": "https://brakemanscanner.org/docs/warning_types/remote_code_execution/",
      "code": "GrdaWarehouse::Cohort.available_columns.map(&:class).map(&:name).select do\n (m == params.require(:field))\n end.first.constantize",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Cohorts::ClientsController",
        "method": "field"
      },
      "user_input": "GrdaWarehouse::Cohort.available_columns.map(&:class)",
      "confidence": "Medium",
      "cwe_id": [
        470
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "a08d95befc1580f092ce13081130707a8ba4077b7241edd87ff59371477ed76c",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "app/controllers/concerns/client_controller.rb",
      "line": 43,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ClientController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "a10e38db6fbbd99c4bff065f90677c565ddd62177052d6245f9d89a292567a90",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 33,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "where(\"#{period}_period_spm_leaver\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PerformanceMetrics::Client",
        "method": "spm_leaver"
      },
      "user_input": "period",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "a5ae0e19f1c215e30af6286dee8a557c5215860d59a3a4c4ca3a914e2aadb58e",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/grda_warehouse/lftp_s3_sync.rb",
      "line": 54,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"mkdir -p #{lftp_bookmark_path}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::LftpS3Sync",
        "method": "set_lftp_bookmark"
      },
      "user_input": "lftp_bookmark_path",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "a9040593943192bed3788b5c04a11f50ce20482af33b84ec76b05e8eec6838c8",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/bi/view_maintainer.rb",
      "line": 412,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "GrdaWarehouseBase.connection.execute(\"DO $$\\nBEGIN\\n  CREATE ROLE #{role} WITH NOLOGIN;\\n  EXCEPTION WHEN DUPLICATE_OBJECT THEN\\n  RAISE NOTICE 'not creating role #{role} -- it already exists';\\nEND\\n$$;\\n\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Bi::ViewMaintainer",
        "method": "safe_create_role"
      },
      "user_input": "role",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "ad042c2ba6d2afb23c6787f70e5955d726e07932c58a8508bb0834a99e207050",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/grda_warehouse/lftp_s3_sync.rb",
      "line": 64,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"echo 'set ssl:verify-certificate no' > #{lftp_config_location}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::LftpS3Sync",
        "method": "set_lftp_confg"
      },
      "user_input": "lftp_config_location",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Cross-Site Scripting",
      "warning_code": 2,
      "fingerprint": "ad643b5cc0525dc24944b965b530e1b65e3c3d7524efb0526565ec3f3f0df4a3",
      "check_name": "CrossSiteScripting",
      "message": "Unescaped model attribute",
      "file": "app/views/messages/show.haml",
      "line": 7,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "simple_format(current_user.messages.find(params.require(:id)).body_html).gsub(URI.regexp([\"http\", \"https\"]), \"<a href=\\\"\\\\0\\\">\\\\0</a>\")",
      "render_path": [
        {
          "type": "controller",
          "class": "MessagesController",
          "method": "show",
          "line": 34,
          "file": "app/controllers/messages_controller.rb",
          "rendered": {
            "name": "messages/show",
            "file": "app/views/messages/show.haml"
          }
        }
      ],
      "location": {
        "type": "template",
        "template": "messages/show"
      },
      "user_input": "current_user.messages.find(params.require(:id))",
      "confidence": "Weak",
      "cwe_id": [
        79
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "b16f9b9fa5ec6ee98d24cc67ae42abf131bc179999e5d2a49491b67783f32dce",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/homeless_summary_report/app/models/homeless_summary_report/report.rb",
      "line": 990,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "clients.send(variant).send(\"spm_#{field}\").average(\"spm_#{field}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "HomelessSummaryReport::Report",
        "method": "calculate"
      },
      "user_input": "field",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "b2c9b6c2e4f603540a84d053a8f50d5208879e95006481a667725bce5fb16b45",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/grda_warehouse/us_census_api/is_a_database_view.rb",
      "line": 50,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.exec_query(\"REFRESH MATERIALIZED VIEW #{@view_name}\\n\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::UsCensusApi::IsADatabaseView::ClassMethods",
        "method": "refresh!"
      },
      "user_input": "@view_name",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": "Injection from internal sources"
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "b2e9f8410ba6ed5963253a0daa5e634213118de8263268da7799b1a3440965fb",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "config/deploy/docker/lib/deployer.rb",
      "line": 157,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "`git rev-parse HEAD > #{_assets_path}/REVISION`",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Deployer",
        "method": "_set_revision!"
      },
      "user_input": "_assets_path",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "b86000207c4fe44ca5dd3bcc3d9a87789cfaab516d90a3c76a5b4a25d8e91e55",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/jobs/worker_status.rb",
      "line": 72,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "`curl -k https://#{ENV[\"FQDN\"]}/system_status/details`",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "WorkerStatus",
        "method": "latest_deployment_is_at_least_partially_finished"
      },
      "user_input": "ENV[\"FQDN\"]",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": "Injected value is from the environment"
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "b943aeb098e1d298b0a93b87df96a6d51af156941a6a8263d4dd96b2add2a5c4",
      "check_name": "Render",
      "message": "Render path contains parameter value",
      "file": "app/views/admin/health/scheduled_documents/_form.haml",
      "line": 25,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(action => scheduled_document_source.find(params[:id]), { :f => f })",
      "render_path": [
        {
          "type": "controller",
          "class": "Admin::Health::ScheduledDocumentsController",
          "method": "edit",
          "line": 39,
          "file": "app/controllers/admin/health/scheduled_documents_controller.rb",
          "rendered": {
            "name": "admin/health/scheduled_documents/edit",
            "file": "app/views/admin/health/scheduled_documents/edit.haml"
          }
        },
        {
          "type": "template",
          "name": "admin/health/scheduled_documents/edit",
          "line": 6,
          "file": "app/views/admin/health/scheduled_documents/edit.haml",
          "rendered": {
            "name": "admin/health/scheduled_documents/_form",
            "file": "app/views/admin/health/scheduled_documents/_form.haml"
          }
        }
      ],
      "location": {
        "type": "template",
        "template": "admin/health/scheduled_documents/_form"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "ba8ebc9d6a0ba16b9729b36fec201710ab5e28db8ca0266ba8df0cc2a56454f1",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 89,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "served(period).where(\"#{period}_period_inactive\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PerformanceMetrics::Client",
        "method": "inactive"
      },
      "user_input": "period",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "bb7696e11e1b7ca5adb22a40badf890b7c2d1349687d26b96e3d2fa728866255",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 14,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "where(\"include_in_#{period}_period\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PerformanceMetrics::Client",
        "method": "served"
      },
      "user_input": "period",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "bc859ee98d096f8661ae7acda9fc8c122004a13934a088f7c73ddbdbe8363a67",
      "check_name": "Redirect",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/user_training_controller.rb",
      "line": 34,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to(Talentlms::Facade.new.course_url(current_user, Talentlms::Config.first.courseid, (clients_url or root_url), logout_talentlms_url))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "UserTrainingController",
        "method": "index"
      },
      "user_input": "Talentlms::Facade.new.course_url(current_user, Talentlms::Config.first.courseid, (clients_url or root_url), logout_talentlms_url)",
      "confidence": "High",
      "cwe_id": [
        601
      ],
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "c0005570a238c0588abb23ceeeca1435585d73471894496817a57ba389867107",
      "check_name": "Render",
      "message": "Render path contains parameter value",
      "file": "app/views/dashboards/base/section.html.haml",
      "line": 2,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(action => (\"dashboards/base/\" + params[:partial]), {})",
      "render_path": null,
      "location": {
        "type": "template",
        "template": "dashboards/base/section"
      },
      "user_input": "params[:partial]",
      "confidence": "Weak",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "c001b77515db71c33c42f71ebb9f55b97fc3fa1dc0f7c8bc3c6255abcf416607",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/grda_warehouse/lftp_s3_sync.rb",
      "line": 65,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "system(\"echo 'set ftp:ssl-protect-data true' >> #{lftp_config_location}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "GrdaWarehouse::LftpS3Sync",
        "method": "set_lftp_confg"
      },
      "user_input": "lftp_config_location",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "c5bd3adf51202218b95877c9d15e95e4053876e998ccaca44a7054ea9efa9803",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/reporting/monthly_reports/base.rb",
      "line": 413,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.execute(\"CREATE TABLE #{Reporting::MonthlyReports::Base.remainder_table} (CHECK ( #{\" type NOT IN ('#{Reporting::MonthlyReports::Base.sub_tables.keys.join(\"', '\")}') \"} ) ) INHERITS (#{Reporting::MonthlyReports::Base.parent_table});\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reporting::MonthlyReports::Base",
        "method": "Reporting::MonthlyReports::Base.ensure_tables"
      },
      "user_input": "Reporting::MonthlyReports::Base.remainder_table",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Cross-Site Scripting",
      "warning_code": 2,
      "fingerprint": "c6d2416929705fe07d75e0cba96b643e0d9361ef1329ece172ff0fcd797deb31",
      "check_name": "CrossSiteScripting",
      "message": "Unescaped model attribute",
      "file": "app/views/admin/users/_login_chart.haml",
      "line": 15,
      "link": "https://brakemanscanner.org/docs/warning_types/cross_site_scripting",
      "code": "ActivityLog.for_chart",
      "render_path": [
        {
          "type": "template",
          "name": "admin/users/index",
          "line": 4,
          "file": "app/views/admin/users/index.haml",
          "rendered": {
            "name": "admin/users/_login_chart",
            "file": "app/views/admin/users/_login_chart.haml"
          }
        }
      ],
      "location": {
        "type": "template",
        "template": "admin/users/_login_chart"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        79
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "c6eb04c800a45639cca6f59d522ba432fc60aecb0f2b1edfe5e807117f190fc7",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 57,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "served(period).where(\"#{period}_period_in_outflow\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Client",
        "method": null
      },
      "user_input": "period",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "cb24bc097afffbd5cf87060d03cc8dbc62621b116886794d375a27bbc5d50b93",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_measurement/app/models/performance_measurement/result_calculation.rb",
      "line": 143,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "projects.joins(:hud_project).merge(GrdaWarehouse::Hud::Project.send(project_type)).group(:project_id).sum(\"#{period}_#{field}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PerformanceMeasurement::ResultCalculation",
        "method": "inventory_sum"
      },
      "user_input": "period",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "cc6ebf15e95f7fb90fd0f2c9861623ef42bfa69d297ee8c0c51583fc7b582cd7",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 29,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "served(period).where(\"#{period}_period_caper_leaver\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Client",
        "method": null
      },
      "user_input": "period",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "cd75e090b221d5a14aeafffafde44c25b0042578a30dc4225d96a1c861f95700",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 33,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "where(\"#{period}_period_spm_leaver\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Client",
        "method": null
      },
      "user_input": "period",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Redirect",
      "warning_code": 18,
      "fingerprint": "cf9fa747c96c496625affc43ebc9ecdb01c696ca61f911e2de7da2f6188b251d",
      "check_name": "Redirect",
      "message": "Possible unprotected redirect",
      "file": "app/controllers/admin/translation_keys_controller.rb",
      "line": 64,
      "link": "https://brakemanscanner.org/docs/warning_types/redirect/",
      "code": "redirect_to(TranslationKey.find(params[:id].to_i))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Admin::TranslationKeysController",
        "method": "update"
      },
      "user_input": "params[:id].to_i",
      "confidence": "Weak",
      "cwe_id": [
        601
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "d0aeca6a54dc98ea4111145a33891543c430827b884255ef5de11c6c3f977b97",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/reporting/monthly_reports/base.rb",
      "line": 469,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.execute(\"select count(*) from information_schema.triggers where trigger_name = '#{trigger_name}'\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reporting::MonthlyReports::Base",
        "method": "Reporting::MonthlyReports::Base.trigger_exists?"
      },
      "user_input": "trigger_name",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 70,
      "fingerprint": "d1df65ed70bfef4890bb44d788400c8da08fb84c088d9b9219c66745d0998cc6",
      "check_name": "MassAssignment",
      "message": "Specify exact keys allowed for mass assignment instead of using `permit!` which allows any keys",
      "file": "app/controllers/application_controller.rb",
      "line": 80,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "params.permit!",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ApplicationController",
        "method": "link_params"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        915
      ],
      "note": ""
    },
    {
      "warning_type": "Mass Assignment",
      "warning_code": 70,
      "fingerprint": "d30f188ab49432871db858350d45e406393f128db844569fd725478c9a189a8a",
      "check_name": "MassAssignment",
      "message": "Specify exact keys allowed for mass assignment instead of using `permit!` which allows any keys",
      "file": "drivers/system_pathways/app/controllers/system_pathways/warehouse_reports/reports_controller.rb",
      "line": 31,
      "link": "https://brakemanscanner.org/docs/warning_types/mass_assignment/",
      "code": "params.permit!",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "SystemPathways::WarehouseReports::ReportsController",
        "method": "show"
      },
      "user_input": null,
      "confidence": "Medium",
      "cwe_id": [
        915
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "d4a7eb345da17652caa7292362ee998634c49e1031ea96c1fdf59c44abb4f6b6",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_measurement/app/models/performance_measurement/result_calculation.rb",
      "line": 139,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "projects.joins(:hud_project).merge(GrdaWarehouse::Hud::Project.send(project_type)).where(:project_id => client_projects.for_question(\"days_in_#{project_type}_bed_in_period\").where(:period => period).distinct.pluck(:project_id)).sum(\"#{period}_#{field}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PerformanceMeasurement::ResultCalculation",
        "method": "inventory_sum"
      },
      "user_input": "period",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "File Access",
      "warning_code": 16,
      "fingerprint": "d9bb80d17d9ee8ce21f0fe7e5f5e15446eaa406057bd5f8f08540740ec295f07",
      "check_name": "FileAccess",
      "message": "Parameter value used in file name",
      "file": "app/controllers/data_quality_reports_controller.rb",
      "line": 88,
      "link": "https://brakemanscanner.org/docs/warning_types/file_access/",
      "code": "File.read(\"app/views/data_quality_reports/#{report_scope.where(:project_id => params[:project_id].to_i).find(params[:id].to_i).model_name.element}/project/README.md\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "DataQualityReportsController",
        "method": "describe_computations"
      },
      "user_input": "params[:id]",
      "confidence": "Weak",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "da084951626e16e5a17884e0640d294e67eeba0a3b094f69cb78877fc8d4518e",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "lib/rds_sql_server/rds.rb",
      "line": 265,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "SqlServerBootstrapModel.connection.execute(\"if not exists(select * from sys.databases where name = '#{database}')\\n  create database #{database}\\n\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Rds",
        "method": "create_database!"
      },
      "user_input": "database",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "db896aac42f010e67b8aa6019c51d80cad8620b1c8a04cfbdad693b190fd3231",
      "check_name": "Render",
      "message": "Render path contains parameter value",
      "file": "drivers/core_demographics_report/app/views/core_demographics_report/warehouse_reports/demographic_summary/section.haml",
      "line": 3,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(action => \"core_demographics_report/warehouse_reports/shared/#{params[:partial]}\", {})",
      "render_path": null,
      "location": {
        "type": "template",
        "template": "core_demographics_report/warehouse_reports/demographic_summary/section"
      },
      "user_input": "params[:partial]",
      "confidence": "Medium",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "e2e1114f02366f89e3a47f9a2368ef4d01d7b1f19ca5e5d715648aab9c8f0fb7",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/hmis_csv_importer/app/models/hmis_csv_importer/aggregated/enrollment.rb",
      "line": 48,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.execute(\"INSERT INTO hmis_aggregated_enrollments (#{((HmisCsvTwentyTwenty::Aggregated::Enrollment.column_names & HmisCsvImporter::Aggregated::Enrollment.column_names) - [\"id\"]).map do\n connection.quote_column_name(name)\n end.join(\", \")}) SELECT #{((HmisCsvTwentyTwenty::Aggregated::Enrollment.column_names & HmisCsvImporter::Aggregated::Enrollment.column_names) - [\"id\"]).map do\n connection.quote_column_name(name)\n end.join(\", \")} FROM hmis_2020_aggregated_enrollments\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "HmisCsvImporter::Aggregated::Enrollment",
        "method": "HmisCsvImporter::Aggregated::Enrollment.migrate_to_unversioned"
      },
      "user_input": "(HmisCsvTwentyTwenty::Aggregated::Enrollment.column_names & HmisCsvImporter::Aggregated::Enrollment.column_names)",
      "confidence": "High",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "e3ce0a7baa215616359faf56fd7e7ad420a3ca38669ed5fe226f241626597710",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/concerns/hmis_structure/base.rb",
      "line": 153,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.execute(\"CREATE INDEX #{((table_name.gsub(/[^0-9a-z ]/i, \"\") + \"_\") + Digest::MD5.hexdigest(columns.join(\"_\"))[0, 4])} ON #{connection.quote_table_name(table_name)} (#{columns.map do\n connection.quote_column_name(c)\n end.join(\", \")}) INCLUDE (#{details[:include].map do\n connection.quote_column_name(c)\n end.join(\", \")})\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "HmisStructure::Base::ClassMethods",
        "method": "hmis_table_create_indices!"
      },
      "user_input": "table_name.gsub(/[^0-9a-z ]/i, \"\")",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "e4f8ccf26e1fd69bcd4fa892bf2291f93f3312d115e805626e4e9984335f08a4",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 81,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "served(period).where(\"#{period}_period_reentering\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PerformanceMetrics::Client",
        "method": "reentering"
      },
      "user_input": "period",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "e52db9a64ac0bf61e35334f89b7703a1a1df7c9fd84a506e575cbd79816712e4",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/bi/view_maintainer.rb",
      "line": 421,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "GrdaWarehouseBase.connection.execute(\"GRANT SELECT ON #{name} TO #{\"bi\"}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Bi::ViewMaintainer",
        "method": "safe_create_view"
      },
      "user_input": "name",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Command Injection",
      "warning_code": 14,
      "fingerprint": "ea3c1a87820e41e4d8e27cdf51aacff4da749f07d72fd29c2386ddc5c7cad731",
      "check_name": "Execute",
      "message": "Possible command injection",
      "file": "app/models/dba/partition_all.rb",
      "line": 21,
      "link": "https://brakemanscanner.org/docs/warning_types/command_injection/",
      "code": "`#{\"egrep -R 'table_name..*#{t}' drivers/hmis_csv_twenty_twenty_two/app/models/hmis_csv_twenty_twenty_two | cut -d: -f1\"}`",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Dba::PartitionAll",
        "method": "add_explicit_primary_key!"
      },
      "user_input": "t",
      "confidence": "Medium",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "ec2a88a0a4dbf17f841d1ed086b8c4e0132b485f2ceea48c39e2fa1715aa2c9a",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/concerns/reporting/project_data_quality_reports/version_four/display.rb",
      "line": 352,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "send(options[:denominator]).group(:project_id).where(\"#{key}_#{:complete}\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reporting::ProjectDataQualityReports::VersionFour::Display",
        "method": "client_data"
      },
      "user_input": "key",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "ec3e12873a47baa3681d97c10127ea6269f92e67c8eb04a70947cf79685943da",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/concerns/reporting/project_data_quality_reports/version_four/support.rb",
      "line": 169,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "send(completeness_metrics[options[:column].to_sym][:denominator]).where(\"#{options[:column].to_sym}_#{options[:metric].to_sym}\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reporting::ProjectDataQualityReports::VersionFour::Support",
        "method": "project_completeness_support"
      },
      "user_input": "options[:column].to_sym",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "ed2ba832272d6ccfc20e3be08bb78afb6461a2b28e1d61e5517ef6863d0e8994",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/report_generators/lsa/fy2021/all.rb",
      "line": 669,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "SqlServerBase.connection.execute((\"\" + \" ALTER TABLE #{table_name} DROP COLUMN id; \"))",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ReportGenerators::Lsa::Fy2021::All",
        "method": "remove_missing_identity_columns"
      },
      "user_input": "table_name",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "ed71e9e26a86213fd628715e0b89c03141496c2418041246aa515f7f86488ec1",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/dba/partition_all.rb",
      "line": 79,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "GrdaWarehouseBase.connection.execute(\"DROP TABLE IF EXSITS \\\"#{table}_saved\\\"\\n\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Dba::PartitionAll",
        "method": "remove_saved_tables!"
      },
      "user_input": "table",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "ef9c705b3ff129992877db4ae4e8a998a8fff80588bd442ebbe677d64135cec2",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_metrics/app/models/performance_metrics/client.rb",
      "line": 85,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "served(period).where(\"#{period}_period_entering_housing\" => true)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PerformanceMetrics::Client",
        "method": "entered_housing"
      },
      "user_input": "period",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "f4d1c2b56088a3db75b8a9bb33adcccb86a50c1c0f36bdbd434aeef9a22dacd5",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "drivers/performance_measurement/app/models/performance_measurement/result_calculation.rb",
      "line": 122,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "clients.joins(:client_projects).merge(PerformanceMeasurement::ClientProject.where(:period => period, :for_question => field)).sum(\"#{period}_#{field}\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "PerformanceMeasurement::ResultCalculation",
        "method": "client_sum"
      },
      "user_input": "period",
      "confidence": "Weak",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "f63dfcbd913306fda069c922d30497437e5ca09abe7fe150d49dcfa3c33afdff",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/service_scanning/app/controllers/service_scanning/services_controller.rb",
      "line": 43,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ServiceScanning::ServicesController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "f63dfcbd913306fda069c922d30497437e5ca09abe7fe150d49dcfa3c33afdff",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/service_scanning/app/controllers/service_scanning/services_controller.rb",
      "line": 48,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ServiceScanning::ServicesController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "f63dfcbd913306fda069c922d30497437e5ca09abe7fe150d49dcfa3c33afdff",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/service_scanning/app/controllers/service_scanning/services_controller.rb",
      "line": 63,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ServiceScanning::ServicesController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "f63dfcbd913306fda069c922d30497437e5ca09abe7fe150d49dcfa3c33afdff",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/service_scanning/app/controllers/service_scanning/services_controller.rb",
      "line": 69,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ServiceScanning::ServicesController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Dangerous Send",
      "warning_code": 23,
      "fingerprint": "f63dfcbd913306fda069c922d30497437e5ca09abe7fe150d49dcfa3c33afdff",
      "check_name": "Send",
      "message": "User controlled method execution",
      "file": "drivers/service_scanning/app/controllers/service_scanning/services_controller.rb",
      "line": 73,
      "link": "https://brakemanscanner.org/docs/warning_types/dangerous_send/",
      "code": "@clients.joins(:processed_service_history).includes(:processed_service_history).where(:id => service_history_service_scope.select(:client_id).distinct.where(:date => ((params[:start_date].to_date..params[:end_date].to_date)))).public_send(params[:population].to_sym)",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "ServiceScanning::ServicesController",
        "method": "sort_filter_index"
      },
      "user_input": "params[:population].to_sym",
      "confidence": "High",
      "cwe_id": [
        77
      ],
      "note": ""
    },
    {
      "warning_type": "Denial of Service",
      "warning_code": 76,
      "fingerprint": "fa3c76143ef1b1af288e9f4ba624abe711f9407919ae94cf296c608cda6d96d8",
      "check_name": "RegexDoS",
      "message": "Model attribute used in regular expression",
      "file": "app/models/health/qualifying_activity.rb",
      "line": 67,
      "link": "https://brakemanscanner.org/docs/warning_types/denial_of_service/",
      "code": "/#{[Health::QualifyingActivityV1, Health::QualifyingActivityV2].map do\n (version::ATTRIBUTE_SUFFIX + \"$\")\n end.join(\"|\")}/",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Health::QualifyingActivity",
        "method": "Health::QualifyingActivity.human_attribute_name"
      },
      "user_input": "[Health::QualifyingActivityV1, Health::QualifyingActivityV2].map",
      "confidence": "Weak",
      "cwe_id": [
        20,
        185
      ],
      "note": ""
    },
    {
      "warning_type": "Dynamic Render Path",
      "warning_code": 15,
      "fingerprint": "fde02e1709a167801d237e080ec6ee9c281c0a4aaaef4e81a09c70c01613e32d",
      "check_name": "Render",
      "message": "Render path contains parameter value",
      "file": "app/views/clients/rollup.haml",
      "line": 2,
      "link": "https://brakemanscanner.org/docs/warning_types/dynamic_render_path/",
      "code": "render(action => (\"clients/rollup/\" + params[:partial]), {})",
      "render_path": null,
      "location": {
        "type": "template",
        "template": "clients/rollup"
      },
      "user_input": "params[:partial]",
      "confidence": "Weak",
      "cwe_id": [
        22
      ],
      "note": ""
    },
    {
      "warning_type": "SQL Injection",
      "warning_code": 0,
      "fingerprint": "fe7de455d82a4e3fef770c1272e861fb8f1d73042b2f82f1b417753f2d17bec7",
      "check_name": "SQL",
      "message": "Possible SQL injection",
      "file": "app/models/reporting/monthly_reports/base.rb",
      "line": 397,
      "link": "https://brakemanscanner.org/docs/warning_types/sql_injection/",
      "code": "connection.execute(\"CREATE TABLE #{details[:table_name]} ( CHECK ( #{\"type = '#{details[:type]}'\"} ) ) INHERITS (#{Reporting::MonthlyReports::Base.parent_table});\")",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Reporting::MonthlyReports::Base",
        "method": "Reporting::MonthlyReports::Base.ensure_tables"
      },
      "user_input": "details[:table_name]",
      "confidence": "Medium",
      "cwe_id": [
        89
      ],
      "note": ""
    },
    {
      "warning_type": "Remote Code Execution",
      "warning_code": 24,
      "fingerprint": "ff4e9944330ec5bf9f13b025d9b4151a4abc8f503b0191e7e6367e206a360fdf",
      "check_name": "UnsafeReflection",
      "message": "Unsafe reflection method `constantize` called on model attribute",
      "file": "drivers/hmis/app/graphql/types/hmis_schema/submit_form_result.rb",
      "line": 34,
      "link": "https://brakemanscanner.org/docs/warning_types/remote_code_execution/",
      "code": "Hmis::Form::Definition::FORM_ROLE_CONFIG.find do\n (value[:class_name] == object.class.name)\n end.last[:resolve_as].constantize",
      "render_path": null,
      "location": {
        "type": "method",
        "class": "Types::HmisSchema::SubmitFormResult",
        "method": "s(:self).resolve_type"
      },
      "user_input": "Hmis::Form::Definition::FORM_ROLE_CONFIG.find",
      "confidence": "Medium",
      "cwe_id": [
        470
      ],
      "note": ""
    }
  ],
  "updated": "2023-09-12 13:01:46 +0000",
  "brakeman_version": "5.4.1"
}
